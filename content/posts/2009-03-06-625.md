---
title: "2009-03-06"
date: 2009-03-06
tags: 
  - "powershell"
---

単純にPowerShellスクリプト終了時に「Exit 1」のようにしてあげれば返せるかと思いきや、「Exit 2」でも「Exit 100」でもすべてerrorlevelは1になってしまいます。

きちんと2以上の値も返したければPowerShellコマンドのcommandオプションでスクリプトを実行させたうえで、「exit $LASTEXITCODE」としてあげればいいそうです。具体的には以下のように。

```
powershell -NoProfile -command ".\hoge.ps1;exit $LASTEXITCODE"
```

元ネタはこちら。

- [The PowerShell Guy : Hey PowerShell Guy How can I run a PowerShell Script from CMD.EXE and return an Errorlevel](http://thepowershellguy.com/blogs/posh/archive/2008/05/20/hey-powershell-guy-how-can-i-run-a-powershell-script-from-cmd-exe-and-return-an-errorlevel.aspx)
