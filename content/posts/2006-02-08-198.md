---
title: "2006-02-08"
date: 2006-02-08
tags: 
  - "pc"
---

先日紹介したexec.vbsのソースコードをみて、どのように実現しているのかを調べてその手法をWebで調べたらすごく良いサイトを発見しました。 [Hey, Scripting Guy!](http://www.microsoft.com/japan/technet/scriptcenter/resources/qanda/dec04/hey1213.mspx)

このサイトに書かれている方法で、WMI, ADSIにて別の資格情報でスクリプトを実行することができます。

また「なぜExec.vbsで実行サーバーとしてローカルコンピューターを指定できないのか」不思議だったのですがそれに関しては以下のように記述がありました。 """1 つ重要な注意があります。この方法では別の資格情報のもとでスクリプトが実行されますが、動作するのはリモート コンピュータ上のみです。なんらかの理由があり、WMI を使用した場合、自分のコンピュータでは、別の資格情報のもとでスクリプトを実行することはできません。実に不思議です。

MSのサイトに「実に不思議です。」と書かれているってのは許されるのでしょうか・・・。

またパスワードをスクリプト内に記述してしまうことに関しては以下の注意が書かれています。

"""1 つ付け加えておきますが、パスワード (特に管理者のパスワード) をスクリプトの中でハードコーディングすることはお勧めしません。そうではなく、コマンドライン引数として、または入力ボックスその他の手段で、パスワードを入力できるようにした方が最善です。

たしかにその通りですが、どうしてもパスワードをスクリプトに埋め込みたい場合には[スクリプトエンコーダー](http://www.microsoft.com/downloads/details.aspx?FamilyID=2976ee94-bec5-4314-84fd-8d7ec891c1c5&displaylang=ja)で暗号化してしまうことで安全性を高められます。ただし、メンテナンス性は低くなりますけれども・・・。

#### 追記

関連記事はこちらにまとめてあります。

- [ebi's webpage - Windows自動化バッドノウハウ](http://ebi.dyndns.biz/hiki.cgi?Windows%BC%AB%C6%B0%B2%BD%A5%D0%A5%C3%A5%C9%A5%CE%A5%A6%A5%CF%A5%A6)
