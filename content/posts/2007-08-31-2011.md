---
title: "2007-08-31"
date: 2007-08-31
categories: 
  - "thinking"
---

久し振りの技術ネタです。Microsoft Office SharePoint 2007にてリストのイベントハンドラーを開発する際の注意点です。まずは、基本的な事項に関しては[SharePoint Services Developer Center|http://www.microsoft.com/japan/msdn/sharepoint/\]\]の\[\[Office Developer Center: 見る the 2007 Microsoft Office system|http://www.microsoft.com/japan/msdn/office/learn/screencasts/default.aspx\]\]内の「Windows SharePoint Services 3.0 を使用したイベント ハンドラの作成とテスト」というWebcastが非常に参考になります。この\[\[Office Developer Center: 見る the 2007 Microsoft Office system](http://www.microsoft.com/japan/msdn/office/learn/screencasts/default.aspx)は非常に参考になるので、すべて目を通すことをお勧めします。

ただし、この開発手法は一世代前というか本当にベーシックなもので、今現在はもっと簡単に開発のできる[Download details: Windows SharePoint Services 3.0 Tools: Visual Studio 2005 Extensions for Windows SharePoint Services 3.0](http://www.microsoft.com/downloads/details.aspx?familyid=19f21e5e-b715-4f0c-b959-8c6dcbdc1057&displaylang=en)というものが出ています。これを使えば、面倒なことは何もなく、参照の追加やスケルトンの作成、ビルド後のフィーチャーの登録からIISの再起動、デバッグまで行えてしまいます。逆に裏で何が起きているのかわからなくなってしまうということはありますが、生産性を求めるならぜひ導入すべきです。

で、[Download details: Windows SharePoint Services 3.0 Tools: Visual Studio 2005 Extensions for Windows SharePoint Services 3.0](http://www.microsoft.com/downloads/details.aspx?familyid=19f21e5e-b715-4f0c-b959-8c6dcbdc1057&displaylang=en)を前提にしたサンプルが以下のあたりにあります。

- [イベントレシーバの作成方法 - SharePoint開発者のWiki - livedoor Wiki（ウィキ）](http://wiki.livedoor.jp/sharepoint/d/%a5%a4%a5%d9%a5%f3%a5%c8%a5%ec%a5%b7%a1%bc%a5%d0%a4%ce%ba%ee%c0%ae%ca%fd%cb%a1)
- [SharePoint開発者のブログ:イベントレシーバのサンプルコード - livedoor Blog（ブログ）](http://blog.livedoor.jp/sharepoint/archives/50120375.html)

で、このサンプルをそのまま書いてビルドすると…リストは登録されて動くのですが、なぜか肝心のイベントハンドラーがイベントを拾わず、全く動いてくれませんでした。これの原因がわからずかなり悩んだのですが結局「きちんとプロジェクトのプロパティから有効にするイベントをTrueにする必要がある」という単純なことが原因でした。常識すぎてどこにも解説が見つけられなかったのでしょうか…。

このあたりの詳細は以下の情報が参考になります。

- [\[方法\] イベント ハンドラ フィーチャーを作成する](http://msdn2.microsoft.com/ja-jp/library/ms453149.aspx)
- [Chris O'Brien's blog: Creating lists with VSeWSS](http://sharepointnutsandbolts.blogspot.com/2007/04/creating-lists-with-vsewss.html)

また、調べてみると、イベントレシーバーを登録するような簡単なアプリケーションを作成している人もいました。

- [Your wish is my command-line: MOSS List Event Receiver Register application](http://lirliron.blogspot.com/2007/08/moss-list-event-receiver-register_08.html)

このあたりの情報がなかなか見つからず半日以上時間を無駄にしてしまったので、誰かの参考になればと思い書いておきます。
