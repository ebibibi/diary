---
title: "2006-04-21"
date: 2006-04-21
categories: 
  - "work"
---

仕事で扱うかもしれないので、マニュアルを一通り読んでみました。率直な感想は、「うん、まぁ、こういう実装になるよね」といったもの。結局OS上で提供されている機能を使ってなんとかこねくり回そうとしているので、やはりMSCSなんかと比べると今一歩洗練されていないなぁと感じました。

基本的には、IPネットワークを使って複製をしますよ、と。通信ができなくなったら切り替わりますよ、と。そういう話です。ポイントはおそらく切り替わった後の話で、元のホスト名とIPアドレスを待機系のホストが持つため、"元のホストが復旧してもそのままではネットワークに接続できない"という制限があるところだと思います。

StorageMirroringが想定している復旧手順はおそらく以下のような感じに思えます。(流し読みしただけなので、間違ってるかもしれません) ・元のホストをネットワークから切り離す ・元のホストの障害を復旧する ・(ここで元のホストをネットワークに戻してはいけない) ・待機系(今アクティブ)のサーバーでフォールバック操作をする(これによって待機状態に戻る) ・(ここでクライアントからは完全にアクセスできなくなる) ・元のホストをネットワークにつなぐとユーザーが古い情報にアクセスしてしまうのでアクセスできないようにする(ファイルサーバーなら共有を消す・・・など?) ・元のホストをネットワークにつなぐ ・元のホストと待機系のサーバーとでストレージの同期をかける(時間は変更量による) ・同期が完了したところで、元のホストを正常な状態に構成しなおす

んー。なかなか面倒な手順です。MSCSだとクリック一発ですから・・・。そう考えると、このソフトは遠隔地でストレージをミラーするような、ディザスタリカバリに使うためのソフトではないか?という気がしてきます。たとえば、ファイルサーバーなら、MSCSでクラスタ構成を組んでおいて、通常の障害には対応し、そのうえで、StorageMirroringにてデータを遠隔地のサーバーとも同期を取っておく。というような使い方です。

でも、そうすると、ホスト名、IPアドレスを引き継ぐことでのフェールオーバーをStorageMirroringで行おうと思っても、遠隔地であるが故にネットワークアドレスが異なってしまい、レイヤー3レベルでルーティングできない・・ということになりそうな気がします。でも、もちろんやろうと思えば遠隔地も同じサブネットで・・・というようにネットワークを構成することはできるのだと思いますがそれって簡単にできるんでしょうか??ネットワークの勉強をしないと駄目ですね・・・。

そもそもStorageMirroringのフェールオーバー機能は、別ネットワークアドレスにホストを置いている構成にも対応してるんでしょうか?していない気がしますね。その部分は別の機器なり仕組みと組み合わせる気がします。それってハードルが高いですね。そういう部分、遠隔地クラスターは考慮されているんだろうか?これも調べてみなければ・・・。

んー。StorageMirroringはデータを集めてバックアップを取る・・・といった用途にとどめておくのが良いような気もしてきました。

全然勘違いをしているかもしれません。鵜呑みにはしないようにお願いします。詳しい人がいたら教えてください。
