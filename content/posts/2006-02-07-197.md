---
title: "2006-02-07"
date: 2006-02-07
tags: 
  - "pc"
---

windowsにおいてはセキュリティ権限を自由に変更し、コマンドを実行するようなことが簡単には出来ません。

一応ユーザーを切り替える方法として以下のものがありますがどれも自動化できないんです!!

- 右クリック→別のユーザーで実行→ID, Passを実行
- タスクスケジューラーをセットし、実行ユーザーを指定
- コマンドプロンプトからRunasコマンドを実行→パスワードを入力

私はSIerなので、端末のセットアップを数百、数千単位で行うようなこともあるのですが(いや、もちろん1人で手でセットアップしたりはしませんよ)、UNIX系ならコマンドと設定ファイル(テキスト)の置き換えで簡単に自動化できてしまうようなことが、Windowsでは素直にやろうとすると、大人数で、マウスをカチカチ、ログオンとログオフを繰り返して、リブートして・・・というような具合で非常に時間がかかります。本当にいやになります・・・。

そこで何とか簡略化、自動化できないかと方策を探してみると・・・結構「お勧めできない」方法が見つかります(笑)。 Microsoftの社員が「これはお勧めできませんが、これしか方法はありません」と紹介してくれているものもあるのだから面白い話です(笑)

たとえばexec.vbsもその一つです。これはWindows2000のResourceKitに入っているVBScriptなのですが、任意のコマンドを任意のサーバーで任意のユーザーで実行させることが出来ます。

Runasとは違いパスワードをコマンドラインに記述できるので、自動化できますし、任意のユーザーで実行できるので便利です。

リソースキット内にあるので無償ではない・・・と思うのですが[こちら](http://www.windowsitpro.com/Article/ArticleID/15598/15598.html)からダウンロードできるので違うのかもしれません。

他にも色々と自動化のためのバッドノウハウがあるので、チョコチョコ紹介していこうと思います。

#### 追記

関連記事はこちらにまとめてあります。

- [ebi's webpage - Windows自動化バッドノウハウ](http://ebi.dyndns.biz/hiki.cgi?Windows%BC%AB%C6%B0%B2%BD%A5%D0%A5%C3%A5%C9%A5%CE%A5%A6%A5%CF%A5%A6)
