---
title: "2007-07-16"
date: 2007-07-16
tags: 
  - "debian"
---

サーバー移動前からちょくちょくなのですが、なぜか嫁に提供しているcourier-imapへの接続が微妙にできなくなります。Loginまではできているのに、なぜか接続が完了しない状態。courier-imapだけの再起動では現象は治らないけれども、サーバー全体をリブートするとしばらくはまた使えるようになる…。このような不可解な現象が起きております。

サーバーを取り替えたら治るかと思ったのですが、治らないので、何か根本的におかしいようです。というわけで、もうちょっと深くみてみようかとおもって、まずはwiresharkでパケットキャプチャを実施。

結果、正常に接続できない場合はクライアントからの「0005 STATUS "INBOX" (MESSAGES UNSEEN UIDNEXT)」という要求に対して、imapサーバーが答えを返していないことが原因であることが判明。(おかしい場合には1行目で止まってしまい下2行がない)

```
0005 STATUS "INBOX" (MESSAGES UNSEEN UIDNEXT)
```

```
* STATUS "INBOX" (MESSAGES 122 UIDNEXT 196 UNSEEN 30)
```

```
0005 OK STATUS Completed.
```

とりあえず間違いなく、imapサーバー側の問題なわけだけれども。何が原因だかとなると・・・。どうやって追ったらいいんだろうか。ちょっとこれは本気で追ってみたい。
