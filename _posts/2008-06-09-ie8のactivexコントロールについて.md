---
title: "IE8のActiveXコントロールについて"
date: 2008-06-09
tags: 
  - "未分類"
---

IE8のレンダリングモードに引き続き、今度はIE8のActiveXコントロールに関してお勉強。

> Microsoftは、Windows VistaとWindows Server 2008で稼働するIE 8では、データ実行防止（DEP：Data Execution Prevention）と非実行ページ保護（NX：No eXxecute）機能をデフォルトでオンにする。  
> [_IE 8でセキュリティ機能のデフォルト設定が変更に - ITmedia エンタープライズ_](http://www.itmedia.co.jp/enterprise/articles/0804/11/news051.html)

ということで、ActiveXコントロールに関しては以下のようにしないとIE8(と、DEPを有効にしたIE7)では動かないらしい。

- アドオンのコードで旧バージョンのATL（Active Template Library）を利用している場合、ATL バージョン7.1 SP1以上（Visual Studio 2005にはATL 8.0が含まれる）で再構築する
- リンカオプション/NXCOMPATを設定し、アドオンがDEP・NXと互換性があることを指定する

とりあえず、Visual Studio 2005あたりで/NXCOMPTオプションをつけて際ビルドすればOKの模様。(理解が浅いです。有識者からの突っ込みをお待ちしております。)

で、これに関しては、そもそもATLって何よ?というレベルでした。今の理解は以下の程度。

- ATLはActiveTemplateLibraryの略でテンプレートベースのC++クラスのライブラリらしい。

- [Active Template Library - Wikipedia](http://ja.wikipedia.org/wiki/Active_Template_Library)
- [ATL リファレンス](http://msdn.microsoft.com/ja-jp/library/t9adwcde.aspx)
- [ATL の概念](http://msdn.microsoft.com/ja-jp/library/3ax346b7\(VS.80\).aspx)

- MFCでActiveXコントロール作成、ATLでActiveXコントロール作成・・・という選択肢があるらしいが、ActiveXコントロール作成に関してはATLで作成するほうがDLLも必要じゃないし、軽量、高速になってよいらしい。

- [ATLとMFCによるActiveXコントロール](http://m--takahashi.com/bbs/pastlog/a5100/A5010.html)

うーん。難しいですね。とりあえずIE8でインストール、動作しないActiveXがあったらUpdateを待てばよいようです・・・・。(弱気
