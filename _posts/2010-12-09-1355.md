---
title: "2010-12-09"
date: 2010-12-09
tags: 
  - "script"
---

Outlookを立ち上げた状態で以下のスクリプトをコマンドプロンプトからcscript hoge.vbsとして実行すると、動きます。

{{'

```
Main

Sub Main()
   Set outlook = CreateObject("Outlook.Application")
   Set namespace = outlook.GetNamespace("MAPI")

   Set rootFolder = namespace.PickFolder
   PrintFolderNames rootFolder,0
End Sub

Sub PrintFolderNames(parentFolder, ByVal depth)
   For Each subFolder in parentFolder.Folders
       On Error Resume Next
       for i=1 To depth Step 1
           WScript.StdOut.Write ","
       Next
       WScript.Echo subFolder.Name
       PrintFolderNames subFolder, depth + 1
   Next
End Sub

```

'}}
